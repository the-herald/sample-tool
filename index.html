<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>PPC Gadget — RSA Builder (Single)</title>
<link rel="icon" href="/favicon.png" />
<style>
  body{font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;margin:0;background:#0b0e13;color:#e8ecf3}
  .wrap{max-width:1000px;margin:0 auto;padding:18px}
  input,textarea{width:100%;padding:10px;border:1px solid #202635;border-radius:10px;background:#121621;color:#e8ecf3}
  label{font-size:12px;color:#9aa3b7}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  .grid3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px}
  .btn{padding:10px 14px;border:1px solid #202635;border-radius:10px;background:#121621;color:#e8ecf3;cursor:pointer}
  .row{margin-bottom:12px}
  .mono{font-family:ui-monospace,SFMono-Regular,Consolas,Menlo,monospace}
  a.btn{display:inline-block;text-decoration:none}
</style>
</head>
<body>
<div class="wrap">
  <h1>RSA Builder (Single)</h1>

  <div class="row grid">
    <div>
      <label>Search Query</label>
      <input id="q" placeholder="sailboat slips near me">
    </div>
    <div>
      <label>Domain (optional)</label>
      <input id="dm" placeholder="example.com">
    </div>
  </div>

  <div class="row grid">
    <div>
      <label>Landing Page URL</label>
      <input id="u" placeholder="https://example.com/sailboat/slips">
    </div>
    <div class="grid">
      <div>
        <label>Path 1</label>
        <input id="p1" placeholder="sailboat">
      </div>
      <div>
        <label>Path 2</label>
        <input id="p2" placeholder="slips">
      </div>
    </div>
  </div>

  <div class="row">
    <label>Headlines (one per line)</label>
    <textarea id="heads" rows="6"></textarea>
  </div>

  <div class="row">
    <label>Descriptions (one per line; Google uses up to 2 together)</label>
    <textarea id="descs" rows="5"></textarea>
  </div>

  <div class="row">
    <label>Callouts (one per line)</label>
    <textarea id="calls" rows="4"></textarea>
  </div>

  <div class="row grid3">
    <div>
      <label>Snippet Header</label>
      <input id="sh" placeholder="Services">
    </div>
    <div style="grid-column: span 2">
      <label>Snippet Values (one per line)</label>
      <textarea id="sv" rows="4"></textarea>
    </div>
  </div>

  <div class="row">
    <button id="share" class="btn">Open Preview</button>
    <a id="previewLink" class="btn" href="#" target="_blank" rel="noopener">Preview Link</a>
  </div>

  <div class="row">
    <label>Hash (debug)</label>
    <div class="mono" id="hash" style="word-break:break-all"></div>
  </div>
</div>

<script>
/* LZString (URI-safe; full) — using same impl as preview for compatibility */
var LZString=function(){function o(o,r){if(!t[o]){t[o]={};for(var n=0;n<o.length;n++)t[o][o.charAt(n)]=n}return t[o][r]}var r=String.fromCharCode,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",t={},e={compressToEncodedURIComponent:function(o){return null==o?"":e._compress(o,6,function(o){return n.charAt(o)})},_compress:function(o,n,t){if(null==o)return"";var e,i,s={},p={},a="",u="",c="",f=2,l=3,h=2,d=[],m=0,v=0;for(i=0;i<o.length;i+=1)if(a=o.charAt(i),Object.prototype.hasOwnProperty.call(s,a)||(s[a]=l++,p[a]=!0),u=c+a,Object.prototype.hasOwnProperty.call(s,u))c=u;else{if(Object.prototype.hasOwnProperty.call(p,c)){if(c.charCodeAt(0)<256){for(e=0;e<h;e++)m<<=1,v==n-1?(v=0,d.push(t(m)),m=0):v++;for(i=c.charCodeAt(0),e=0;e<8;e++)m=m<<1|1&i,v==n-1?(v=0,d.push(t(m)),m=0):v++;}else{for(i=1,e=0;e<h;e++)m=m<<1|i,v==n-1?(v=0,d.push(t(m)),m=0):v++;for(i=c.charCodeAt(0),e=0;e<16;e++)m=m<<1|1&i,v==n-1?(v=0,d.push(t(m)),m=0):v++;}f--,0==f&&(f=Math.pow(2,h),h++),delete p[c]}else{for(i=s[c],e=0;e<h;e++)m=m<<1|1&i,v==n-1?(v=0,d.push(t(m)),m=0):v++}f--,0==f&&(f=Math.pow(2,h),h++),s[u]=l++,c=String(a)}if(""!==c){if(Object.prototype.hasOwnProperty.call(p,c)){if(c.charCodeAt(0)<256){for(e=0;e<h;e++)m<<=1,v==n-1?(v=0,d.push(t(m)),m=0):v++;for(i=c.charCodeAt(0),e=0;e<8;e++)m=m<<1|1&i,v==n-1?(v=0,d.push(t(m)),m=0):v++;}else{for(i=1,e=0;e<h;e++)m=m<<1|i,v==n-1?(v=0,d.push(t(m)),m=0):v++;for(i=c.charCodeAt(0),e=0;e<16;e++)m=m<<1|1&i,v==n-1?(v=0,d.push(t(m)),m=0):v++;}f--,0==f&&(f=Math.pow(2,h),h++),delete p[c]}else{for(i=s[c],e=0;e<h;e++)m=m<<1|1&i,v==n-1?(v=0,d.push(t(m)),m=0):v++}f--,0==f&&(f=Math.pow(2,h),h++),i=2;for(e=0;e<h;e++)m=m<<1|1&i,v==n-1?(v=0,d.push(t(m)),m=0):v++;for(;;){if(m<<=1,v==n-1){d.push(t(m));break}v++}return d.join("")},};return e}();

/* helpers */
const $ = s => document.querySelector(s);
const lines = v => (v||'').split(/\r?\n/).map(x=>x.trim()).filter(Boolean);

function buildPayload(){
  // short keys to keep JSON minimal
  const payload = {
    q: $('#q').value.trim(),
    dm: $('#dm').value.trim(),         // domain (display domain)
    u:  $('#u').value.trim(),          // landing page
    p1: $('#p1').value.trim(),
    p2: $('#p2').value.trim(),
    h:  lines($('#heads').value),
    d:  lines($('#descs').value),
    c:  lines($('#calls').value),
    sh: $('#sh').value.trim(),
    sv: lines($('#sv').value)
  };
  return payload;
}

function makeLink(){
  const payload = buildPayload();
  const json = JSON.stringify(payload);
  const hash = LZString.compressToEncodedURIComponent(json);
  const url = `./preview.html#${hash}`;
  $('#hash').textContent = hash;
  $('#previewLink').href = url;
  return url;
}

document.getElementById('share').onclick = ()=>{ window.open(makeLink(), '_blank'); };
</script>
</body>
</html>
